# AtCoder Beginner Contest 224
2021-10-23(土) 21:00 ~ 2021-10-23(土) 22:40 (100分)

## A - Tires
https://atcoder.jp/contests/abc224/tasks/abc224_a

<details><summary>クリックで解説を開く</summary>

### キーワード
- 文字列の処理
- 簡単な条件分岐(if文)

</details>


## B - Mongeness
https://atcoder.jp/contests/abc224/tasks/abc224_b

<details><summary>クリックで解説を開く</summary>

<br>

"abc224_b 1.py"は愚直な実装、"abc224_b 2.py"は公式の解説に書いてある事実を使って実装した $`O(N^2)`$ 解法。

### キーワード
- 多重for文
- Monge配列, Monge行列

</details>


## C - Triangle?
https://atcoder.jp/contests/abc224/tasks/abc224_c

<details><summary>クリックで解説を開く</summary>

<br>

**微妙な解法**<br>
2点の傾きを求めてカウントしておく。3点の選び方 $`_N\mathrm{C}_3 = N(N-1)(N-2) ÷ 6`$ から、傾きが同じ3点の選び方を引く。

↑間違いではないのですが、傾きが無限大になる2点の選び方の扱いに困りますし、小数の誤差に気を配る必要があり面倒です。

公式の解説にある通り、$`O(N^3)`$ 解法でも通るので、無理せずこの解法を選ぶことをオススメします。

### キーワード
- 幾何
- 場合の数(?)
- 全探索

</details>


## F - Problem where +s Separate Digits
https://atcoder.jp/contests/abc224/tasks/abc224_f

<details><summary>クリックで解説を開く</summary>

<br>

$`S`$ の長さを $`n`$ とする。

もし $`T`$ としてあり得る全ての式に対して式を計算して総和を求めていたら、計算量が $`O(2^n)`$ とか $`O(n2^n)`$ になり、余裕でTLE。

そこでまず思いつくのは主客転倒。$`S`$ の $`i`$ 文字目(上から $`i`$ 桁目。以降、$`S_i`$ とする。)が答えにどれほど寄与するかを考える。<br>
ここで考えるべきは、$`S_i`$ が、10の何乗の位として足されるのか、そしてそれが何通りあるのか。

$`S_i`$ が、$`10^j (0 ≤ j ≤ n-i)`$ の位として足される場合の数は、$`S`$ の $`i`$ 文字目までの `+` の有無により $`2^{i-1}`$ 通り、後ろ $`j`$ 箇所は `+` 無しで確定、さらにその後ろ1箇所は `+` 有りで確定、残りの $`n-i-j-1`$ 箇所の `+` の有無により $`2^{n-i-j-1}`$ 通り。ただし $`n-i-j=0`$ の場合は例外で(先ほどまで `+` 有りで確定していた箇所が $`S`$ の末尾にあたる。)、別で足し合わせる。

以上より、$`S_i`$ の答えへの寄与は、

```math
S_i × 10^{n-i} × 2^{i-1} + \sum_{j=0}^{n-i-1} S_i × 10^j × 2^{i-1} × 2^{n-i-j-1}
```

これを $`i (1 ≤ i ≤ n)`$ について足し合わせればよいのだが、計算量は $`O(n^2)`$ となり、これでもTLEになってしまう。<br>
そこで、後半のΣの部分は、等比数列の和の公式を用いて計算量 $`O(1)`$ で求められるようにする。<br>
以下、コードを書くことを想定して、$`i`$ を0始まりにしている。

```math
\begin{align*}
& \sum_{i=0}^{n-1} \left( S_i × 10^{n-i-1} × 2^i + \sum_{j=0}^{n-i-2} S_i × 10^j × 2^i × 2^{n-i-j-2} \right) \\
=& \sum_{i=0}^{n-1} \left( S_i × 2^i × \left( 10^{n-i-1} + \sum_{j=0}^{n-i-2} 10^j × 2^{n-i-j-2} \right) \right) \\
=& \sum_{i=0}^{n-2} \left( S_i × 2^i × \left( 10^{n-i-1} + \sum_{j=0}^{n-i-2} 10^j × 2^{n-i-j-2} \right) \right) + S_{n-1} × 2^{n-1} \\
=& \sum_{i=0}^{n-2} \left( S_i × 2^i × \left( 10^{n-i-1} + \frac{2^{n-i-2} \left( 5^{n-i-1} - 1 \right)}{5-1} \right) \right) + S_{n-1} × 2^{n-1}
\end{align*}
```

"abc224_f 2.py"は、以下の解説(行列の積を用いる解法)を実装したもの。<br>
https://atcoder.jp/contests/abc224/editorial/2830

ちなみにnumpyで行列の演算をしたところ、TLEとなってしまった("abc224_f 3(TLE).py")。<br>
行列の積を求める途中で剰余演算ができないため、数字が大きくなってしまうのが原因と思われる。<br>
"abc224_f 2.py"のように自力で実装する場合、途中で剰余演算ができる。

### キーワード
- 主客転倒
- 等比数列の和
- 累積和
- modの逆元
- 行列の積

</details>
